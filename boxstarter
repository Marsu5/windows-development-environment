# Configure Windows
Set-WindowsExplorerOptions -EnableShowHiddenFilesFoldersDrives -EnableShowProtectedOSFiles -EnableShowFileExtensions -EnableShowFullPathInTitleBar

Update-ExecutionPolicy Unrestricted

# Packages
cinst -y hyper

## Node, npm
cinst -y nodejs.install
cinst -y yarn
refreshenv

npm install --global --production windows-build-tools
npm install -g npm-windows-upgrade
npm install -g hpm-cli

## Git
cinst -y git.install -params "/GitAndUnixToolsOnPath /NoShellIntegration"
cinst -y poshgit 

## Editors
cinst -y visualstudiocode

## Visual Studio 2017
cinst -y visualstudio2017community
if (Test-PendingReboot) { Invoke-Reboot }

## Go, Python
cinst -y golang

cinst -y python
cinst -y pip

if (Test-PendingReboot) { Invoke-Reboot }

## Basics
cinst -y sysinternals
cinst -y DotNet3.5
cinst -y googlechrome
if (Test-PendingReboot) { Invoke-Reboot }

# Let's get Updates, too
Install-WindowsUpdate -acceptEula

# Setup PowerShell profile
if(Test-Path $HOME\Documents\WindowsPowerShell\){
    Invoke-WebRequest "https://raw.githubusercontent.com/mrclsu/windows-development-environment/master/Microsoft.PowerShell-profile.ps1" -OutFile "Microsoft.PowerShell-profile.ps1"
    Copy-Item .\Microsoft.PowerShell-profile.ps1 $HOME\Documents\WindowsPowerShell\profile.ps1
}else{
    mkdir $HOME\Documents\WindowsPowerShell\
    Invoke-WebRequest "https://raw.githubusercontent.com/mrclsu/windows-development-environment/master/Microsoft.PowerShell-profile.ps1" -OutFile "Microsoft.PowerShell-profile.ps1"
    Copy-Item .\Microsoft.PowerShell-profile.ps1 $HOME\Documents\WindowsPowerShell\profile.ps1
}